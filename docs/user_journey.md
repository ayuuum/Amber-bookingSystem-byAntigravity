# ユーザージャーニー（User Journey）

本文書では、Amber プラットフォームにおける主要な役割（ロール）ごとの行動フローを定義します。特に事業者側（本部・店舗）のオンボーディングと運用の違いに焦点を当てます。

---

## 0. 事業者オンボーディング比較（Onboarding Comparison）

Amber はマルチテナント構造を採用しており、フランチャイズ本部（Super Admin）と各店舗管理者（Store Admin）では、開始までのステップが異なります。

### A. フランチャイズ本部 / 経営者（Super Admin）
組織全体のオーナーとして、インフラと決済基盤を構築します。

```mermaid
graph TD
    HQ1[アカウント作成/組織登録] --> HQ2[Stripe Connect 連携: 決済基盤構築]
    HQ2 --> HQ3[プラン選択/機能権限設定]
    HQ3 --> HQ4[店舗（Stores）の一括/個別作成]
    HQ4 --> HQ5[店舗管理者の招待/権限付与]
    HQ5 --> HQ6[全店舗のパフォーマンス監視開始]
```

### B. 店舗管理者 / 店長（Store Admin）
特定の店舗の責任者として、現場の稼働環境を整えます。

```mermaid
graph TD
    SA1[招待承諾/ログイン] --> SA2[店舗プロフィール設定: 営業時間・住所]
    SA2 --> SA3[サービス・オプションのカスタマイズ]
    SA3 --> SA4[所属スタッフ登録 & シフト設定]
    SA4 --> SA5[店舗専用 予約URL/LINE連携の公開]
    SA5 --> SA6[日々の予約管理・現場指示開始]
```

---

## 1. 役割別の主な運用フロー（Operational Flows）

| 役割 | オンボーディングの鍵 | 日次の主要アクション | 意思決定の範囲 |
| :--- | :--- | :--- | :--- |
| **フランチャイズ本部** | 決済基盤（Stripe）と組織構造の定義 | 全店舗の売上監視、手数料精算、新店舗開設 | 組織全体のプラン、全店舗のデータ閲覧 |
| **店舗管理者** | リソース（スタッフ・シフト）の確定 | 予約調整、スタッフへの指示、顧客対応、店舗売上管理 | 自店舗のメニュー価格、シフト、自店舗顧客 |
| **現場スタッフ** | アプリの使い方と施工記録の習得 | ステータス更新（開始/完了）、施工写真・メモ登録 | 自身の担当予約の詳細確認・記録 |

---

## 2. 顧客のジャーニー（Customer Journey）

一般消費者がサービスを発見し、予約・決済を経て施工完了、その後のリピートに至るまでのフローです。

```mermaid
graph TD
    A[予約サイト/LINE] --> B{サービス選択}
    B --> C[日時・オプション選択]
    C --> D{決済方法選択}
    D -->|オンライン決済| E[Stripe決済実行]
    D -->|現地決済| F[店舗承認待ち]
    E --> G[予約確定通知]
    F --> G
    G --> H[前日リマインド]
    H --> I[当日出発通知]
    I --> J[施工完了・サンキュー送信]
    J --> K[レビュー投稿/家カルテ閲覧]
    K --> L[定期メンテナンス提案]
    L --> B
```

---

## 3. 現場スタッフのジャーニー（Staff Journey）

現場で作業を行うスタッフが、一日のスケジュールを確認し、現場での作業を記録・報告するフローです。

```mermaid
graph TD
    S1[当日スケジュール確認] --> S2[顧客情報・過去履歴の予習]
    S2 --> S3[出発通知送信]
    S3 --> S4[現場到着・作業開始記録]
    S4 --> S5[施工前写真撮影]
    S5 --> S6[現場作業]
    S6 --> S7[施工後写真撮影・メモ入力]
    S7 --> S8[完了報告・ステータス更新]
    S8 --> S9[現地決済処理]
    S9 --> S10[次現場へ移動]
```

---

## 4. 将来のジャーニー（Phase 2.0+: AI Agent）

AIが電話やLINEで顧客と対話し、自動で予約を完結させる高度なフローです。

```mermaid
sequenceDiagram
    participant 顧客
    participant AIエージェント
    participant Amberシステム
    
    顧客->>AIエージェント: 「来週の土曜日にエアコン掃除できる？」
    AIエージェント->>Amberシステム: 空き枠照会
    Amberシステム-->>AIエージェント: 土曜10:00が空いています
    AIエージェント->>顧客: 「10時から可能です。2台で18,000円です。予約しますか？」
    顧客->>AIエージェント: 「はい、お願いします」
    AIエージェント->>Amberシステム: 予約確定処理
    Amberシステム->>顧客: LINEで予約確定通知を送信
```
